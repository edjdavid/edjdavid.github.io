var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,c){a!=Array.prototype&&a!=Object.prototype&&(a[d]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,d,c,b){if(d){c=$jscomp.global;a=a.split(".");for(b=0;b<a.length-1;b++){var g=a[b];g in c||(c[g]={});c=c[g]}a=a[a.length-1];b=c[a];d=d(b);d!=b&&null!=d&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:d})}};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},d={};try{return d.__proto__=a,d.a}catch(c){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,d){a.__proto__=d;if(a.__proto__!==d)throw new TypeError(a+" is not extensible");return a}:null;$jscomp.polyfill("Object.setPrototypeOf",function(a){return a||$jscomp.setPrototypeOf},"es6","es5");
var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var b in c)c.hasOwnProperty(b)&&(a[b]=c[b])};return function(d,c){function b(){this.constructor=d}a(d,c);d.prototype=null===c?Object.create(c):(b.prototype=c.prototype,new b)}}(),Animator;
(function(a){var d=function(){function b(g,a,e,c){var f=this;this.pathLoc=0;this.noAnim=!1;this.animDone=null;this.getElement=function(){return f.elem};this.elem=g;this.simTime=e||3600/b.config.simStep;this.name=c;this.startTime=a||0;this.assignID();this.addMarker();b.features.push(this)}b.animateAll=function(){b.timer=d3.timer(b.config.timerCallback)};b.each=function(g,a){for(var f in b.features)g(b.features[f],a)};b._runAnimate=function(b,a){b.animDone||b.animate(a)};b.timerCallback=function(a){b.each(b._runAnimate,
a);a=c.config.displayTime(a);c.config.onAnimationStep();(null===c.config.endTime||a>c.config.endTime)&&b.timer.stop()};b.prototype.assignID=function(){this.getElement().id="feature-"+b.idCtr;b.idCtr+=1};b.prototype.getSvg=function(){var b=this.getElement().parentNode;return null===b?null:b.parentNode};b.prototype.getStartPoint=function(){var b=this.getElement().getPointAtLength(0);return b.x+","+b.y};b.prototype.addMarker=function(){var b=d3.select(this.getElement()),a=d3.select(this.getSvg()),e=
this.getStartPoint();a=a.append("circle");a.attr("r",2).attr("id","marker-"+b.attr("id")).attr("transform","translate("+e+")").attr("class","path-marker");this.marker=a};b.prototype.removeMarker=function(){this.marker.remove();delete this.marker};b.prototype.noop=function(){};b.prototype.onAnimationStart=function(){b.config.onAnimationStart(this)};b.prototype.onAnimationEnd=function(){b.config.onAnimationEnd(this)};b.prototype.reposition=function(){var b=this.getElement(),a=b.getTotalLength(),e=a*
this.pathLoc;isNaN(e)||0===e||(0<this.pathLoc&&!this.animDone&&d3.select(b).attr("stroke-dasharray",e+","+a),b=b.getPointAtLength(e),this.marker&&this.marker.attr("transform","translate("+b.x+","+b.y+")"))};b.prototype.onZoomEnd=function(){this.reposition()};b.prototype.animate=function(a){var f=a-this.startTime;if(!(0>f)){null===this.animDone&&(this.onAnimationStart(),this.animDone=!1);a=this.getElement();var e=a.getTotalLength();f=e/this.simTime*(f/b.config.time);f>e?(this.onAnimationEnd(),this.animDone=
!0,this.removeMarker(),this.pathLoc=1,d3.select(a).attr("stroke-opacity",.3).attr("stroke-dasharray",null)):d3.select(a).attr("stroke-opacity",.45).attr("stroke-dasharray",f+","+e);this.pathLoc=f/e;this.marker&&(a=a.getPointAtLength(f),this.marker.attr("transform","translate("+a.x+","+a.y+")"))}};b.idCtr=0;b.features=[];b.config={time:100,simStep:60,startTime:(new Date).getTime(),runTime:1E4,endTime:null,onAnimationStart:function(b){},onAnimationEnd:function(b){},onAnimationStep:function(){},timerCallback:b.timerCallback,
displayTime:function(a){a=new Date(a/b.config.time*1E3*b.config.simStep+c.config.startTime);d3.select("#date").text([a.getFullYear(),("0"+(a.getMonth()+1)).slice(-2),("0"+a.getDate()).slice(-2)].join("/"));return a}};return b}();a.Features=d;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}__extends(b,a);return b}(d);a.Path=c;d=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.noAnim=!0;return b}__extends(b,a);b.prototype.addMarker=function(){};
b.prototype.reposition=function(){};b.prototype.onAnimationEnd=function(){};b.prototype.animate=function(a){0>a-this.startTime||null!==this.animDone||(this.animDone=!0,this.onAnimationStart())};return b}(d);a.Point=d})(Animator||(Animator={}));
(function(a){function d(){a.Features.config.startTime=(new Date("2009-01-01T00:00:00")).getTime();a.Features.config.simStep=2419200;a.Features.config.endTime=new Date("2020-01-01T00:00:00");a.Features.config.onAnimationStart=function(a){d3.select("#message").text(a.name);try{var e=b.layerPointToLatLng(a.getElement().getPointAtLength(0))}catch(h){e=L.latLng(a.getElement().title.split(","))}var c=document.getElementById("p-"+a.getElement().id);if(null!==c){var d=document.createElement("div");d.classList.add("job-label");
d.innerHTML=a.name;L.popup({closeButton:!1}).setContent(c.innerHTML+d.outerHTML).setLatLng(e).addTo(b)}};a.Features.config.onAnimationEnd=function(){d3.select("#message").text("")};a.Features.config.onAnimationStep=function(){var c=a.Features.features[g];if(c&&!c.noAnim){var e=c.getElement(),d=e.getTotalLength();0!==d&&(e=e.getPointAtLength(d*c.pathLoc),e=b.layerPointToLatLng(L.point(e.x,e.y)),b.panTo(e))}c&&c.animDone&&(g+=1)}}function c(c){b=L.map("map",{center:[14.654895,121.065019],zoom:14,closePopupOnClick:!1});
L.tileLayer("http://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",{attribution:'<a href="https://github.com/edjdavid">edjdavid</a> &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',subdomains:"abcd",maxZoom:15}).addTo(b);L.geoJSON(c,{pointToLayer:function(a,b){return L.marker(b,{title:b.lat+","+b.lng})},style:{color:"#ff7800",weight:4,opacity:0}}).addTo(b).eachLayer(function(b){var c=b.feature.properties.name,
d=((new Date(b.feature.properties.startTime)).getTime()-a.Features.config.startTime)/a.Features.config.simStep*a.Features.config.time/1E3;if("LineString"!==b.feature.geometry.type)new a.Point(b.getElement(),d,0,c);else{var e=b.feature.properties.duration/a.Features.config.simStep;new a.Path(b.getElement(),d,e,c)}});b.on("moveend",function(){a.Features.each(function(a){a.onZoomEnd()},null)})}var b,g=0;d3.queue().defer(d3.json,"files/map.geojson").await(function(b,e){b&&console.log(b);d();c(e);a.Features.animateAll()});
window.f=a.Features})(Animator||(Animator={}));
